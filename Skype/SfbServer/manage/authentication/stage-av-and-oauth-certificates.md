---
title: Fase certificados AV y OAuth en Skype para Business Server utilizando - Roll en Set-CsCertificate
ms.author: heidip
author: microsoftheidi
manager: serdars
ms.audience: ITPro
ms.topic: article
ms.prod: skype-for-business-itpro
localization_priority: Normal
ms.collection: IT_Skype16
ms.assetid: 22dec3cc-4b6b-4df2-b269-5b35df4731a7
description: 'Resumen: Fase AV OAuth certificados y de Skype para Business Server.'
ms.openlocfilehash: 9fd4074034e9bff6b27ed9a22143c59dc9890821
ms.sourcegitcommit: 27f1ecb730355dcfac2f4be3f5642f383d5532ad
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 02/21/2019
ms.locfileid: "25375939"
---
# <a name="stage-av-and-oauth-certificates-in-skype-for-business-server-using--roll-in-set-cscertificate"></a><span data-ttu-id="0ab5f-103">Fase certificados AV y OAuth en Skype para Business Server utilizando - Roll en Set-CsCertificate</span><span class="sxs-lookup"><span data-stu-id="0ab5f-103">Stage AV and OAuth certificates in Skype for Business Server using -Roll in Set-CsCertificate</span></span>
 
<span data-ttu-id="0ab5f-104">**Resumen:** Fase AV y OAuth certificados para Skype para Business Server.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-104">**Summary:** Stage AV and OAuth certificates for Skype for Business Server.</span></span>
  
<span data-ttu-id="0ab5f-105">Audio y vídeo (A / V) communications es un componente clave de Skype para Business Server.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-105">Audio/Video (A/V) communications is a key component of Skype for Business Server.</span></span> <span data-ttu-id="0ab5f-106">Características como la conferencia de uso compartido y audio y vídeo de la aplicación se basan en los certificados asignados a los / servicio perimetral A/v, específicamente el A / servicio de autenticación de V.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-106">Features such as application sharing and audio and video conferencing rely on the certificates assigned to the A/V Edge service, specifically the A/V Authentication service.</span></span>
  
> [!IMPORTANT]
> <span data-ttu-id="0ab5f-107">Esta nueva característica está diseñada para trabajar en lugar de A / servicio perimetral A/v y el certificado OAuthTokenIssuer.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-107">This new feature is designed to work for the A/V Edge service and the OAuthTokenIssuer certificate.</span></span> <span data-ttu-id="0ab5f-108">Otros tipos de certificados se pueden aprovisionar junto con el / servicio perimetral A/v y OAuth tipo de certificado, pero no se beneficiarán del comportamiento de coexistencia que el / será el certificado del servicio perimetral A/v.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-108">Other certificate types can be provisioned along with the A/V Edge service and OAuth certificate type, but will not benefit from the coexistence behavior that the A/V Edge service certificate will.</span></span>
  
<span data-ttu-id="0ab5f-109">El Skype para cmdlets de PowerShell de Shell de administración de servidor empresarial que se usan para administrar Skype para certificados de servidor empresarial hace referencia al servicio perimetral A/v como el tipo de certificado AudioVideoAuthentication y el certificado OAuthServer como typeOAuthTokenIssuer.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-109">The Skype for Business Server Management Shell PowerShell cmdlets used to manage Skype for Business Server certificates refers to the A/V Edge service certificate as the AudioVideoAuthentication certificate type and the OAuthServer certificate as typeOAuthTokenIssuer.</span></span> <span data-ttu-id="0ab5f-110">Para el resto de este tema y para identificar de forma exclusiva los certificados, se utilizará el nombre para el mismo tipo de identificador, AudioVideoAuthentication andOAuthTokenIssuer.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-110">For the rest of this topic and to uniquely identify the certificates, they will be referred to by the same identifier type, AudioVideoAuthentication andOAuthTokenIssuer.</span></span>
  
<span data-ttu-id="0ab5f-111">El servicio de autenticación A/V es responsable de emitir tokens que usan los clientes y otros consumidores de A/V.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-111">The A/V Authentication service is responsible for issuing tokens that are used by clients and other A/V consumers.</span></span> <span data-ttu-id="0ab5f-112">Los tokens se generan a partir de atributos del certificado y, cuando el certificado expira, se produce la pérdida de conexión y es necesario volver a unirse con un nuevo token generado por el nuevo certificado.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-112">The tokens are generated from attributes on the certificate, and when the certificate expires, loss of connection and requirement to rejoin with a new token generated by the new certificate will result.</span></span> <span data-ttu-id="0ab5f-113">Una nueva característica de Skype para Business Server va a solucionar este problema - la posibilidad de organizar un nuevo certificado antes de la antigua uno a expirar y permitir que ambos certificados continuar funcionando durante un período de tiempo.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-113">A new feature in Skype for Business Server will alleviate this problem - the ability to stage a new certificate in advance of the old one expiring and allowing both certificates to continue to function for a period of time.</span></span> <span data-ttu-id="0ab5f-114">Esta característica usa funcionalidad actualizada en el Skype Set-CsCertificate para cmdlet del Shell de administración de servidor empresarial.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-114">This feature uses updated functionality in the Set-CsCertificate Skype for Business Server Management Shell cmdlet.</span></span> <span data-ttu-id="0ab5f-115">El nuevo parámetro-Roll, con el parámetro existente - EffectiveDate, colocará el nuevo certificado AudioVideoAuthentication en el almacén de certificados.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-115">The new parameter -Roll, with the existing parameter -EffectiveDate, will place the new AudioVideoAuthentication certificate in the certificate store.</span></span> <span data-ttu-id="0ab5f-116">El certificado AudioVideoAuthentication más antiguo permanecerá todavía para validar con él los tokens emitidos.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-116">The older AudioVideoAuthentication certificate will still remain for issued tokens to be validated against.</span></span> <span data-ttu-id="0ab5f-117">A partir de la implementación del nuevo certificado AudioVideoAuthentication, se producirá la siguiente serie de eventos:</span><span class="sxs-lookup"><span data-stu-id="0ab5f-117">Beginning with putting the new AudioVideoAuthentication certificate in place, the following series of events will occur:</span></span>
  
> [!TIP]
> <span data-ttu-id="0ab5f-118">Usa el Skype para cmdlets de Shell de administración de servidor empresarial para la administración de certificados, puede solicitar certificados independientes y distintos para cada propósito en el servidor perimetral.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-118">Using the Skype for Business Server Management Shell cmdlets for managing certificates, you can request separate and distinct certificates for each purpose on the Edge Server.</span></span> <span data-ttu-id="0ab5f-119">Usar al Asistente para certificados en el Skype para el Asistente para la implementación de servidor de Business le ayuda a crear certificados, pero normalmente es del tipo **predeterminado** qué parejas todos los certificados se usa para el servidor perimetral en un solo certificado.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-119">Using the Certificate Wizard in the Skype for Business Server Deployment Wizard assists you in creating certificates, but is typically of the **default** type which couples all certificate uses for the Edge Server onto a single certificate.</span></span> <span data-ttu-id="0ab5f-120">La práctica recomendada si va a usar la característica de certificado sucesiva es desacoplar el certificado AudioVideoAuthentication desde otros propósitos de certificado.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-120">The recommended practice if you are going to use the rolling certificate feature is to decouple the AudioVideoAuthentication certificate from the other certificate purposes.</span></span> <span data-ttu-id="0ab5f-121">Puede aprovisionar y provisionalmente un certificado del tipo predeterminado, pero solo la parte AudioVideoAuthentication del certificado combinada se beneficiará de realización de pruebas.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-121">You can provision and stage a certificate of the Default type, but only the AudioVideoAuthentication portion of the combined certificate will benefit from the staging.</span></span> <span data-ttu-id="0ab5f-122">Un usuario utilizado (por ejemplo) en una conversación de mensajería cuando expire el certificado instantánea tendrá que cerrar la sesión y volver a iniciarla para realizar el uso del nuevo certificado asociado con el servicio de servidor perimetral de acceso.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-122">A user involved in (for example) an instant messaging conversation when the certificate expires will need to log out and log back in to make use of the new certificate associated with the Access Edge service.</span></span> <span data-ttu-id="0ab5f-123">Se producirá un comportamiento similar para un usuario que participa en una conferencia Web con el servicio de servidor perimetral de conferencia Web.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-123">Similar behavior will occur for a user involved in a Web conference using the Web Conferencing Edge service.</span></span> <span data-ttu-id="0ab5f-124">El certificado OAuthTokenIssuer es un tipo específico que se comparte entre todos los servidores.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-124">The OAuthTokenIssuer certificate is a specific type that is shared across all servers.</span></span> <span data-ttu-id="0ab5f-125">Puede crear y administrar el certificado en un solo lugar y se almacena el certificado en el almacén de Administración Central para todos los demás servidores.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-125">You create and manage the certificate in one place and the certificate is stored in the Central Management store for all other servers.</span></span>
  
<span data-ttu-id="0ab5f-126">Se necesitan detalles adicionales para comprender los requisitos y opciones cuando mediante el cmdlet Set-CsCertificate y usarlo para certificados de fase antes de la actual del certificado a expirar.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-126">Additional detail is needed to fully understand your options and requirements when using the Set-CsCertificate cmdlet and using it to stage certificates prior to the current certificate expiring.</span></span> <span data-ttu-id="0ab5f-127">-Roll parámetro es importante, pero básicamente único propósito.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-127">The -Roll parameter is important, but essentially single purpose.</span></span> <span data-ttu-id="0ab5f-128">Si define como un parámetro, está indicando a Set-CsCertificate que va a proporcionar información sobre el certificado que se verán afectado definido por - tipo (por ejemplo AudioVideoAuthentication y OAuthTokenIssuer), cuando se convertirán en el certificado eficaces definido por - EffectiveDate.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-128">If you define it as a parameter, you are telling Set-CsCertificate that you will be providing information about the certificate that will be affected defined by -Type (for example AudioVideoAuthentication and OAuthTokenIssuer), when the certificate will become effective defined by -EffectiveDate.</span></span>
  
 <span data-ttu-id="0ab5f-129">**-Roll**:-Roll parámetro es necesario y tiene dependencias que se deben proporcionar junto con ella.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-129">**-Roll**: The -Roll parameter is required and has dependencies that must be supplied along with it.</span></span> <span data-ttu-id="0ab5f-130">Parámetros necesarios para definir por completo los certificados que se verán afectados y cómo se aplicarán:</span><span class="sxs-lookup"><span data-stu-id="0ab5f-130">Required parameters to fully define which certificates will be affected and how they will be applied:</span></span>
  
 <span data-ttu-id="0ab5f-131">**-EffectiveDate**: el parámetro - EffectiveDate define cuando el nuevo certificado se convertirá en co-active con el certificado actual.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-131">**-EffectiveDate**: The parameter -EffectiveDate defines when the new certificate will become co-active with the current certificate.</span></span> <span data-ttu-id="0ab5f-132">-EffectiveDate puede estar cerca de la fecha de caducidad del certificado actual, o puede ser un período de tiempo más largo.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-132">The -EffectiveDate can be close to the expiry time of the current certificate, or it can be a longer period of time.</span></span> <span data-ttu-id="0ab5f-133">Un recomendado mínimo - EffectiveDate para el certificado AudioVideoAuthentication serían 8 horas, que es la duración del token predeterminado para el servidor perimetral AV. tokens de servicio emitido mediante el certificado AudioVideoAuthentication.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-133">A recommended minimum -EffectiveDate for the AudioVideoAuthentication certificate would be 8 hours, which is the default token lifetime for AV Edge service tokens issued using the AudioVideoAuthentication certificate.</span></span>
  
<span data-ttu-id="0ab5f-134">Cuando el almacenamiento provisional OAuthTokenIssuer certificados, hay distintos requisitos para el tiempo de entrega antes de que el certificado puede llegar a ser eficaz.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-134">When staging OAuthTokenIssuer certificates, there are different requirements for the lead time before the certificate can become effective.</span></span> <span data-ttu-id="0ab5f-135">El tiempo mínimo que debe tener el certificado OAuthTokenIssuer para su tiempo de entrega es 24 horas antes de la hora de expiración del certificado actual.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-135">The minimum time that the OAuthTokenIssuer certificate should have for its lead time is 24 hours before the expiration time of the current certificate.</span></span> <span data-ttu-id="0ab5f-136">El tiempo de entrega ampliado para la coexistencia es debido a otros roles de servidor que son dependientes en el certificado OAuthTokenIssuer (Exchange Server, por ejemplo) que tiene un mayor tiempo de conservación de la clave de cifrado y la autenticación de certificado creado materiales.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-136">The extended lead time for the coexistence is because of other server roles that are dependent on the OAuthTokenIssuer certificate (Exchange Server, for example) which has a longer retention time for certificate created authentication and encryption key materials.</span></span>
  
 <span data-ttu-id="0ab5f-137">**-Huella digital**: la huella digital es un atributo en el certificado que es exclusivo de ese certificado.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-137">**-Thumbprint**: The thumbprint is an attribute on the certificate that is unique to that certificate.</span></span> <span data-ttu-id="0ab5f-138">La - huella digital del parámetro se usa para identificar el certificado que se verán afectado por las acciones del cmdlet Set-CsCertificate.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-138">The -Thumbprint parameter is used to identify the certificate that will be affected by the actions of the Set-CsCertificate cmdlet.</span></span>
  
 <span data-ttu-id="0ab5f-139">**-Tipo**:-tipo de parámetro puede aceptar un tipo de uso único certificado o una lista separada por comas de tipos de uso de certificados.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-139">**-Type**: The -Type parameter can accept a single certificate usage type or a comma separated list of certificate usage types.</span></span> <span data-ttu-id="0ab5f-140">Los tipos de certificados son aquellos que identifique al cmdlet y al servidor ¿qué es el propósito del certificado.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-140">The certificate types are those that identify to the cmdlet and to the server what the purpose of the certificate is.</span></span> <span data-ttu-id="0ab5f-141">Por ejemplo, el tipo AudioVideoAuthentication es para su uso por el / servicio perimetral A/v y el servicio de autenticación de AV.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-141">For example, type AudioVideoAuthentication is for use by the A/V Edge service and the AV Authentication service.</span></span> <span data-ttu-id="0ab5f-142">Si decide certificados de aprovisionamiento y la fase de un tipo diferente al mismo tiempo, debe tener en cuenta la más larga requiere eficaz plazo mínimo para los certificados.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-142">If you decide to stage and provision certificates of a different type at the same time, you must consider the longest required minimum effective lead time for the certificates.</span></span> <span data-ttu-id="0ab5f-143">Por ejemplo, necesitará certificados de fase de tipo AudioVideoAuthentication y OAuthTokenIssuer.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-143">For example, you need to stage certificates of type AudioVideoAuthentication and OAuthTokenIssuer.</span></span> <span data-ttu-id="0ab5f-144">Su - EffectiveDate mínimo debe ser mayor de los dos certificados, en este caso el OAuthTokenIssuer, que tiene un plazo mínimo de 24 horas.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-144">Your minimum -EffectiveDate must be the greater of the two certificates, in this case the OAuthTokenIssuer, which has a minimum lead time of 24 hours.</span></span> <span data-ttu-id="0ab5f-145">Si no desea provisionalmente el certificado AudioVideoAuthentication con un plazo de 24 horas, provisionalmente por separado con un EffectiveDate que es más a sus necesidades.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-145">If you do not want to stage the AudioVideoAuthentication certificate with a lead time of 24 hours, stage it separately with an EffectiveDate that is more to your requirements.</span></span>
  
### <a name="to-update-or-renew-an-av-edge-service-certificate-with-a--roll-and--effectivedate-parameters"></a><span data-ttu-id="0ab5f-146">Para actualizar o renovar un certificado de servicio perimetral A/v con - Roll y - EffectiveDate parámetros</span><span class="sxs-lookup"><span data-stu-id="0ab5f-146">To update or renew an A/V Edge service certificate with a -Roll and -EffectiveDate parameters</span></span>

1. <span data-ttu-id="0ab5f-147">Inicie sesión en el equipo local como miembro del grupo Administradores.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-147">Log on to the local computer as a member of the Administrators group.</span></span>
    
2. <span data-ttu-id="0ab5f-148">Solicite una renovación o un nuevo certificado AudioVideoAuthentication con clave privada exportable para el certificado existente en el / servicio perimetral A/v.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-148">Request a renewal or new AudioVideoAuthentication certificate with exportable private key for the existing certificate on the A/V Edge service.</span></span>
    
3. <span data-ttu-id="0ab5f-149">Importe el nuevo certificado AudioVideoAuthentication para el servidor perimetral y todos los otros servidor perimetral en el grupo de servidores (si tiene un grupo de servidores implementado).</span><span class="sxs-lookup"><span data-stu-id="0ab5f-149">Import the new AudioVideoAuthentication certificate to the Edge Server and all other Edge Server in your pool (if you have a pool deployed).</span></span>
    
4. <span data-ttu-id="0ab5f-150">Configurar el certificado importado con el cmdlet Set-CsCertificate y usar parámetro - Roll con el parámetro - EffectiveDate.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-150">Configure the imported certificate with the Set-CsCertificate cmdlet and use the -Roll parameter with the -EffectiveDate parameter.</span></span> <span data-ttu-id="0ab5f-151">La fecha efectiva debe definirse como expire el certificado actual tiempo (14: 00:00 o 2:00:00 P.M.) menos duración del token (de ocho horas de forma predeterminada).</span><span class="sxs-lookup"><span data-stu-id="0ab5f-151">The effective date should be defined as the current certificate expire time (14:00:00, or 2:00:00 PM) minus token lifetime (by default eight hours).</span></span> <span data-ttu-id="0ab5f-152">Esto nos da una hora en que el certificado se debe establecer en activo y es - EffectiveDate \<cadena\>: "22/7/2015 6:00:00 AM".</span><span class="sxs-lookup"><span data-stu-id="0ab5f-152">This gives us a time that the certificate must be set to active, and is the -EffectiveDate \<string\>: "7/22/2015 6:00:00 AM".</span></span> 
    
    > [!IMPORTANT]
    > <span data-ttu-id="0ab5f-153">Para un grupo de servidores perimetrales, debe tener todos los certificados AudioVideoAuthentication implementado y aprovisionados por la fecha y hora definidos por el parámetro - EffectiveDate del primer certificado implementado para evitar una posible / interrupción de V communications debido a la versión más antigua el certificado a expirar antes de que se han renovado todos los tokens de cliente y consumidor con el nuevo certificado.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-153">For an Edge pool, you must have all AudioVideoAuthentication certificates deployed and provisioned by the date and time defined by the -EffectiveDate parameter of the first certificate deployed to avoid possible A/V communications disruption due to the older certificate expiring before all client and consumer tokens have been renewed using the new certificate.</span></span> 
  
    <span data-ttu-id="0ab5f-154">El Set-CsCertificate de comando con el - parámetro Roll y - hora efectiva:</span><span class="sxs-lookup"><span data-stu-id="0ab5f-154">The Set-CsCertificate command with the -Roll and -EffectiveTime parameter:</span></span>
    
   ```
   Set-CsCertificate -Type AudioVideoAuthentication -Thumbprint
          <thumb print of new certificate> -Roll -EffectiveDate <date and time
          for certificate to become active>
   ```

    <span data-ttu-id="0ab5f-155">Un comando Set-CsCertificate de ejemplo:</span><span class="sxs-lookup"><span data-stu-id="0ab5f-155">An example Set-CsCertificate command:</span></span>
    
   ```
   Set-CsCertificate -Type AudioVideoAuthentication -Thumbprint
          "B142918E463981A76503828BB1278391B716280987B" -Roll -EffectiveDate "7/22/2015
          6:00:00 AM"
   ```

    > [!IMPORTANT]
    > <span data-ttu-id="0ab5f-156">El EffectiveDate debe tener el formato para que coincida con la región de su servidor y la configuración de idioma.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-156">The EffectiveDate must be formatted to match your server's region and language settings.</span></span> <span data-ttu-id="0ab5f-157">En el ejemplo se usa la configuración de idioma y región inglés con nosotros</span><span class="sxs-lookup"><span data-stu-id="0ab5f-157">The example uses the US English Region and Language settings</span></span> 
  
<span data-ttu-id="0ab5f-158">Para comprender mejor el proceso que Set-CsCertificate, - Roll y - EffectiveDate se usa para organizar un nuevo certificado para emitir tokens de AudioVideoAuthentication nuevo sin dejar de usar un certificado existente para validar AudioVideoAuthentication que están en uso los consumidores, una escala de tiempo visual es un medio eficaz de descripción del proceso.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-158">To further understand the process that Set-CsCertificate, -Roll, and -EffectiveDate use to stage a new certificate for issuing new AudioVideoAuthentication tokens while still using an existing certificate to validate AudioVideoAuthentication that are in use by consumers, a visual timeline is an effective means of understanding the process.</span></span> <span data-ttu-id="0ab5f-159">En el siguiente ejemplo, el administrador determina que el certificado del servicio perimetral A/v es a punto de caducar a las 2:00:00 P.M. en 22/07/2015.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-159">In the following example, the administrator determines that the A/V Edge service certificate is due to expire at 2:00:00 PM on 07/22/2015.</span></span> <span data-ttu-id="0ab5f-160">Solicita y recibe un certificado nuevo y lo importa a cada servidor perimetral de su grupo de servidores.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-160">He requests and receives a new certificate and imports it to each Edge Server in his pool.</span></span> <span data-ttu-id="0ab5f-161">A las 2 A.M. en 22/07/2015, inicia la ejecución de Get-CsCertificate con - Roll, - huella digital igual a la cadena de la huella digital del certificado nuevo y - hora efectiva establecen en 22/07/2015 6:00:00 AM.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-161">At 2 AM on 07/22/2015, he begins running Get-CsCertificate with -Roll, -Thumbprint equal to the thumbprint string of the new certificate, and -EffectiveTime set to 07/22/2015 6:00:00 AM.</span></span> <span data-ttu-id="0ab5f-162">Este comando ejecuta en cada servidor perimetral.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-162">He runs this command on each Edge Server.</span></span>
  
![Usar los parámetros Roll y EffectiveDate.](../../media/Ops_Certificate_Set_Roll_EffectiveTime_Timeline.jpg)
  
|<span data-ttu-id="0ab5f-164">**Llamada**</span><span class="sxs-lookup"><span data-stu-id="0ab5f-164">**Callout**</span></span>|<span data-ttu-id="0ab5f-165">**Fase**</span><span class="sxs-lookup"><span data-stu-id="0ab5f-165">**Stage**</span></span>|
|:-----|:-----|
|<span data-ttu-id="0ab5f-166">1</span><span class="sxs-lookup"><span data-stu-id="0ab5f-166">1</span></span>  <br/> |<span data-ttu-id="0ab5f-167">Inicio: 22/7/2015 12:00:00 A.M.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-167">Start: 7/22/2015 12:00:00 AM</span></span>  <br/> <span data-ttu-id="0ab5f-168">El certificado AudioVideoAuthentication actual está a punto de caducar a las 2:00:00 P.M. en 22/7/2015.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-168">The current AudioVideoAuthentication certificate is due to expire at 2:00:00 PM on 7/22/2015.</span></span> <span data-ttu-id="0ab5f-169">Esto viene determinado por la expira la marca de tiempo en el certificado.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-169">This is determined by the expires time stamp on the certificate.</span></span> <span data-ttu-id="0ab5f-170">Planear la sustitución del certificado y conversión para tener en cuenta una superposición de 8 horas (duración del token de forma predeterminada) antes de la alcanza certificado existente el plazo de caducidad.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-170">Plan your certificate replacement and rollover to account for an 8 hour overlap (default token lifetime) before the existing certificate reaches the expire time.</span></span> <span data-ttu-id="0ab5f-171">El tiempo de entrega de 2:00:00 AM se usa en este ejemplo para permitir que el Administrador de tiempo suficiente para colocar y aprovisionar los certificados nuevos antes de la hora efectiva de 6:00:00 AM.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-171">The 2:00:00 AM lead time is used in this example to allow the administrator adequate time to place and provision the new certificates in advance of the 6:00:00 AM effective time.</span></span>  <br/> |
|<span data-ttu-id="0ab5f-172">2</span><span class="sxs-lookup"><span data-stu-id="0ab5f-172">2</span></span>  <br/> |<span data-ttu-id="0ab5f-173">22/7/2015 2:00:00 AM - 22/7/2015 5:59:59 A.M.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-173">7/22/2015 2:00:00 AM - 7/22/2015 5:59:59 AM</span></span>  <br/> <span data-ttu-id="0ab5f-174">Configurar certificados en los servidores perimetrales con tiempo eficaz de 6:00:00 AM (4 horas plazo es para este ejemplo, pero puede ser más larga) utilizando Set-CsCertificate-tipo \<tipo de uso del certificado\> -huella digital \<huella digital del certificado nuevo\> - Roll - EffectiveDate \<cadena de fecha y hora de la hora efectiva de nuevo certificado\></span><span class="sxs-lookup"><span data-stu-id="0ab5f-174">Set Certificates on Edge Servers with effective time of 6:00:00 AM (4 hour lead time is for this example, but can be longer) using Set-CsCertificate -Type \<certificate usage type\> -Thumbprint \<thumbprint of new certificate\> -Roll -EffectiveDate \<datetime string of the effective time for new certificate\></span></span>  <br/> |
|<span data-ttu-id="0ab5f-175">3</span><span class="sxs-lookup"><span data-stu-id="0ab5f-175">3</span></span>  <br/> |<span data-ttu-id="0ab5f-176">22/7/2015 6:00 AM - 22/7/2015 2:00 P.M.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-176">7/22/2015 6:00 AM - 7/22/2015 2:00 PM</span></span>  <br/> <span data-ttu-id="0ab5f-177">Para validar los tokens, el nuevo certificado se intenta en primer lugar y, si se produce un error en el nuevo certificado validar el token, el certificado antiguo se intenta.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-177">To validate tokens, the new certificate is tried first, and if the new certificate fails to validate the token, the old certificate is tried.</span></span> <span data-ttu-id="0ab5f-178">Este proceso se usa para todos los símbolos (token) durante el período de superposición de 8 horas (duración del token de forma predeterminada).</span><span class="sxs-lookup"><span data-stu-id="0ab5f-178">This process is used for all tokens during the 8 hour (default token lifetime) overlap period.</span></span>  <br/> |
|<span data-ttu-id="0ab5f-179">4</span><span class="sxs-lookup"><span data-stu-id="0ab5f-179">4</span></span>  <br/> |<span data-ttu-id="0ab5f-180">Fin: 22/7/2015 2:00:01 P.M.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-180">End: 7/22/2015 2:00:01 PM</span></span>  <br/> <span data-ttu-id="0ab5f-181">Ha caducado el certificado antiguo y el nuevo certificado ha pasado a través de.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-181">Old certificate has expired and the new certificate has taken over.</span></span> <span data-ttu-id="0ab5f-182">Certificado antiguo puede quitarse de manera segura con Remove-CsCertificate-tipo \<tipo de uso del certificado\> -anterior</span><span class="sxs-lookup"><span data-stu-id="0ab5f-182">Old certificate can be safely removed with Remove-CsCertificate -Type \<certificate usage type\> -Previous</span></span>  <br/> |
   
<span data-ttu-id="0ab5f-183">Cuando se alcanza el tiempo eficaz (22/7/2015 6:00:00 AM), todos los nuevos tokens emitidos por el nuevo certificado.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-183">When the effective time is reached (7/22/2015 6:00:00 AM), all new tokens are issued by the new certificate.</span></span> <span data-ttu-id="0ab5f-184">Al validar los tokens, tokens en primer lugar se validará con el nuevo certificado.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-184">When validating tokens, tokens will first be validated against the new certificate.</span></span> <span data-ttu-id="0ab5f-185">Si se produce un error en la validación, se intenta el certificado antiguo.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-185">If the validation fails, the old certificate is tried.</span></span> <span data-ttu-id="0ab5f-186">El proceso de intentar la copia nuevo y caída para el certificado antiguo continuará hasta la fecha de caducidad del certificado anterior.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-186">The process of trying the new and falling back to the old certificate will continue until the expiry time of the old certificate.</span></span> <span data-ttu-id="0ab5f-187">Una vez que ha caducado el certificado antiguo (22/7/2015 2:00:00 P.M.), los tokens se validará sólo por el nuevo certificado.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-187">Once the old certificate has expired (7/22/2015 2:00:00 PM), tokens will only be validated by the new certificate.</span></span> <span data-ttu-id="0ab5f-188">El certificado antiguo puede quitarse de manera segura con el cmdlet Remove-CsCertificate con el - parámetro anterior.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-188">The old certificate can be safely removed using the Remove-CsCertificate cmdlet with the -Previous parameter.</span></span>

```
Remove-CsCertificate -Type AudioVideoAuthentication -Previous
```

### <a name="to-update-or-renew-an-oauthtokenissuer-certificate-with-a--roll-and--effectivedate-parameters"></a><span data-ttu-id="0ab5f-189">Para actualizar o renovar un OAuthTokenIssuer con - Roll y - EffectiveDate parámetros de certificados</span><span class="sxs-lookup"><span data-stu-id="0ab5f-189">To update or renew an OAuthTokenIssuer certificate with a -Roll and -EffectiveDate parameters</span></span>

1. <span data-ttu-id="0ab5f-190">Inicie sesión en el equipo local como miembro del grupo Administradores.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-190">Log on to the local computer as a member of the Administrators group.</span></span>
    
2. <span data-ttu-id="0ab5f-191">Solicite una renovación o un nuevo certificado OAuthTokenIssuer con clave privada exportable para el certificado existente en el servidor Front-End.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-191">Request a renewal or new OAuthTokenIssuer certificate with exportable private key for the existing certificate on the Front End Server.</span></span>
    
3. <span data-ttu-id="0ab5f-192">Importe el nuevo certificado OAuthTokenIssuer a un servidor Front-End en el grupo de servidores (si tiene un grupo de servidores implementado).</span><span class="sxs-lookup"><span data-stu-id="0ab5f-192">Import the new OAuthTokenIssuer certificate to a Front End Server in your pool (if you have a pool deployed).</span></span> <span data-ttu-id="0ab5f-193">El certificado OAuthTokenIssuer se replica globalmente y sólo necesita ser actualizado y renovar en cualquier servidor de la implementación.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-193">The OAuthTokenIssuer certificate is replicated globally and only needs to be updated and renewed at any server in your deployment.</span></span> <span data-ttu-id="0ab5f-194">El servidor Front-End se usa como ejemplo.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-194">The Front End Server is used as an example.</span></span>
    
4. <span data-ttu-id="0ab5f-195">Configurar el certificado importado con el cmdlet Set-CsCertificate y usar parámetro - Roll con el parámetro - EffectiveDate.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-195">Configure the imported certificate with the Set-CsCertificate cmdlet and use the -Roll parameter with the -EffectiveDate parameter.</span></span> <span data-ttu-id="0ab5f-196">La fecha efectiva debe definirse como expire el certificado actual tiempo (14: 00:00 o 2:00:00 P.M.) menos un mínimo de 24 horas.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-196">The effective date should be defined as the current certificate expire time (14:00:00, or 2:00:00 PM) minus a minimum of 24 hours.</span></span> 
    
    <span data-ttu-id="0ab5f-197">El Set-CsCertificate de comando con el - parámetro Roll y - hora efectiva:</span><span class="sxs-lookup"><span data-stu-id="0ab5f-197">The Set-CsCertificate command with the -Roll and -EffectiveTime parameter:</span></span>
    
   ```
   Set-CsCertificate -Type OAuthTokenIssuer -Thumbprint <thumb
          print of new certificate> -Roll -EffectiveDate <date and time for
          certificate to become active> -identity Global 
   ```

<span data-ttu-id="0ab5f-198">Un comando Set-CsCertificate de ejemplo:</span><span class="sxs-lookup"><span data-stu-id="0ab5f-198">An example Set-CsCertificate command:</span></span>
    
  ```
  Set-CsCertificate -Type OAuthTokenIssuer -Thumbprint
          "B142918E463981A76503828BB1278391B716280987B" -Roll -EffectiveDate "7/21/2015
          1:00:00 PM" 
  ```

> [!IMPORTANT]
> <span data-ttu-id="0ab5f-199">El EffectiveDate debe tener el formato para que coincida con la región de su servidor y la configuración de idioma.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-199">The EffectiveDate must be formatted to match your server's region and language settings.</span></span> <span data-ttu-id="0ab5f-200">En el ejemplo se usa la configuración de idioma y región inglés con nosotros</span><span class="sxs-lookup"><span data-stu-id="0ab5f-200">The example uses the US English Region and Language settings</span></span> 
  
<span data-ttu-id="0ab5f-201">Cuando se alcanza el tiempo eficaz (21/7/2015 1:00:00 A.M.), todos los nuevos tokens emitidos por el nuevo certificado.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-201">When the effective time is reached (7/21/2015 1:00:00 AM), all new tokens are issued by the new certificate.</span></span> <span data-ttu-id="0ab5f-202">Al validar los tokens, tokens en primer lugar se validará con el nuevo certificado.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-202">When validating tokens, tokens will first be validated against the new certificate.</span></span> <span data-ttu-id="0ab5f-203">Si se produce un error en la validación, se intenta el certificado antiguo.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-203">If the validation fails, the old certificate is tried.</span></span> <span data-ttu-id="0ab5f-204">El proceso de intentar la copia nuevo y caída para el certificado antiguo continuará hasta la fecha de caducidad del certificado anterior.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-204">The process of trying the new and falling back to the old certificate will continue until the expiry time of the old certificate.</span></span> <span data-ttu-id="0ab5f-205">Una vez que ha caducado el certificado antiguo (22/7/2015 2:00:00 P.M.), los tokens se validará sólo por el nuevo certificado.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-205">Once the old certificate has expired (7/22/2015 2:00:00 PM), tokens will only be validated by the new certificate.</span></span> <span data-ttu-id="0ab5f-206">El certificado antiguo puede quitarse de manera segura con el cmdlet Remove-CsCertificate con el - parámetro anterior.</span><span class="sxs-lookup"><span data-stu-id="0ab5f-206">The old certificate can be safely removed using the Remove-CsCertificate cmdlet with the -Previous parameter.</span></span>
```
Remove-CsCertificate -Type OAuthTokenIssuer -Previous 
```

## <a name="see-also"></a><span data-ttu-id="0ab5f-207">Consulte también</span><span class="sxs-lookup"><span data-stu-id="0ab5f-207">See also</span></span>

[<span data-ttu-id="0ab5f-208">Administrar la autenticación de servidor a servidor (OAuth) y las aplicaciones asociadas en Skype para Business Server</span><span class="sxs-lookup"><span data-stu-id="0ab5f-208">Manage server-to-server authentication (OAuth) and partner applications in Skype for Business Server</span></span>](server-to-server-and-partner-applications.md)

[<span data-ttu-id="0ab5f-209">Set-CsCertificate</span><span class="sxs-lookup"><span data-stu-id="0ab5f-209">Set-CsCertificate</span></span>](https://docs.microsoft.com/powershell/module/skype/set-cscertificate?view=skype-ps)
  
[<span data-ttu-id="0ab5f-210">Remove-CsCertificate</span><span class="sxs-lookup"><span data-stu-id="0ab5f-210">Remove-CsCertificate</span></span>](https://docs.microsoft.com/powershell/module/skype/remove-cscertificate?view=skype-ps)